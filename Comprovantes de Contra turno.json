{"files":[{"id":"","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  },\n  \"oauthScopes\": [\n    \"https://www.googleapis.com/auth/documents\",\n    \"https://www.googleapis.com/auth/drive\",\n    \"https://www.googleapis.com/auth/script.external_request\"\n  ]\n}"},{"id":"915a1012-a83c-4321-8c6e-2059294b8a9b","name":"C√≥digo","type":"server_js","source":"function doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027index\u0027)\n    .setTitle(\u0027Declara√ß√£o de Contraturno\u0027);\n}\n\nfunction gerarDeclaracaoComparecimento(dados) {\n  const modeloId \u003d \"13-DnDgrM1518J2K-PYKqrU45KGqYTDqtgZXZlYYrP78\"; \n  const pastaDestinoId \u003d \"19HmC02-9OY9cqTrTyIV5nzmstLgjZkpg\";\n\n  let horario;\n  if (dados.turno \u003d\u003d\u003d \u0027EPT\u0027) {\n    horario \u003d \"14h10 √†s 17h50\";\n  } else if (dados.turno \u003d\u003d\u003d \u0027ECI\u0027) {\n    horario \u003d \"08h00 √†s 11h30\";\n  } else {\n    throw new Error(\"Turno inv√°lido.\");\n  }\n\n  const pastaDestino \u003d DriveApp.getFolderById(pastaDestinoId);\n  const copia \u003d DriveApp.getFileById(modeloId).makeCopy(`Declara√ß√£o - ${dados.nome}`, pastaDestino);\n  const doc \u003d DocumentApp.openById(copia.getId());\n  const corpo \u003d doc.getBody();\n\n  corpo.replaceText(\u0027{{nome}}\u0027, dados.nome);\n  corpo.replaceText(\u0027{{RG}}\u0027, dados.rg);\n  corpo.replaceText(\u0027{{HORARIO}}\u0027, horario);\n  corpo.replaceText(\u0027{{CURSO}}\u0027, dados.curso);\n\n  // Gerar data atual por extenso\n  const dataHoje \u003d new Date();\n  const dataExtenso \u003d formatarDataPorExtenso(dataHoje);\n\n  corpo.replaceText(\u0027{{DATA_HOJE}}\u0027, dataExtenso);\n\n  doc.saveAndClose();\n\n  const url \u003d `https://docs.google.com/document/d/${doc.getId()}/edit`;\n  return `‚úÖ Declara√ß√£o gerada para ${dados.nome}!\u003cbr\u003e\u003ca href\u003d\"${url}\" target\u003d\"_blank\"\u003eüëâ Abrir Documento\u003c/a\u003e`;\n}\n\n// Fun√ß√£o para formatar a data por extenso em pt-BR\nfunction formatarDataPorExtenso(data) {\n  const meses \u003d [\n    \"janeiro\", \"fevereiro\", \"mar√ßo\", \"abril\", \"maio\", \"junho\",\n    \"julho\", \"agosto\", \"setembro\", \"outubro\", \"novembro\", \"dezembro\"\n  ];\n\n  const dia \u003d data.getDate();\n  const mes \u003d meses[data.getMonth()];\n  const ano \u003d data.getFullYear();\n\n  return `${dia} de ${mes} de ${ano}`;\n}\n"},{"id":"96ae3357-ab9a-46b4-b462-039d71bf290e","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003cstyle\u003e\n      body {\n        font-family: Arial, sans-serif;\n        background: linear-gradient(135deg, #1e3c72, #2a5298);\n        color: #fff;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 100vh;\n        margin: 0;\n      }\n\n      .container {\n        background: rgba(255, 255, 255, 0.1);\n        padding: 30px;\n        border-radius: 15px;\n        box-shadow: 0 0 15px rgba(0,0,0,0.4);\n        width: 100%;\n        max-width: 500px;\n      }\n\n      h2 {\n        text-align: center;\n        margin-bottom: 20px;\n      }\n\n      label {\n        display: block;\n        margin-top: 10px;\n        font-weight: bold;\n        color: #eee;\n      }\n\n      input, select {\n        width: 100%;\n        padding: 10px;\n        margin-top: 5px;\n        border-radius: 8px;\n        border: 1px solid #ccc;\n        background: rgba(255,255,255,0.9);\n        box-sizing: border-box;\n        color: #000;\n      }\n\n      button {\n        width: 100%;\n        margin-top: 20px;\n        padding: 12px;\n        border: none;\n        border-radius: 10px;\n        background: #111;\n        color: #fff;\n        font-size: 16px;\n        cursor: pointer;\n      }\n\n      button:hover {\n        background: #444;\n      }\n\n      #mensagem {\n        margin-top: 15px;\n        font-weight: bold;\n        text-align: center;\n      }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cdiv class\u003d\"container\"\u003e\n      \u003ch2\u003eüìÑ Declara√ß√£o de Contraturno\u003c/h2\u003e\n\n      \u003clabel\u003eNome:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"nome\" placeholder\u003d\"Ex: Lucas Pereira Thom√© da Silva\"\u003e\n\n      \u003clabel\u003eRG:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"rg\" placeholder\u003d\"Ex: 39.359.550-X\"\u003e\n\n      \u003clabel\u003eTurno:\u003c/label\u003e\n      \u003cselect id\u003d\"turno\"\u003e\n        \u003coption value\u003d\"EPT\"\u003eEPT (14h10 √†s 17h50)\u003c/option\u003e\n        \u003coption value\u003d\"ECI\"\u003eECI (08h00 √†s 11h30)\u003c/option\u003e\n      \u003c/select\u003e\n\n      \u003clabel\u003eCurso:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"curso\" placeholder\u003d\"Ex: T√©cnico em Inform√°tica\"\u003e\n\n      \u003cbutton onclick\u003d\"gerarDeclaracao()\"\u003eGerar Declara√ß√£o\u003c/button\u003e\n\n      \u003cdiv id\u003d\"mensagem\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003cscript\u003e\n      function gerarDeclaracao() {\n        const dados \u003d {\n          nome: document.getElementById(\"nome\").value,\n          rg: document.getElementById(\"rg\").value,\n          turno: document.getElementById(\"turno\").value,\n          curso: document.getElementById(\"curso\").value\n        };\n\n        document.getElementById(\"mensagem\").innerText \u003d \"‚è≥ Gerando...\";\n\n        google.script.run\n          .withSuccessHandler(msg \u003d\u003e document.getElementById(\"mensagem\").innerHTML \u003d msg)\n          .withFailureHandler(err \u003d\u003e document.getElementById(\"mensagem\").innerText \u003d \"‚ùå Erro: \" + err.message)\n          .gerarDeclaracaoComparecimento(dados);\n      }\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}
