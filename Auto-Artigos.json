{"files":[{"id":"23dc2947-ac48-4643-8dd1-3f8b8c64832f","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"},{"id":"45881d73-cb21-4a6e-b1d0-ac52410a9d98","name":"Código","type":"server_js","source":"function renumerarArtigosSemSimbolo() {\n  const doc \u003d DocumentApp.openById(\"1bN91wlYFt2JJ1mta9KLQBOAIL47OYeZHDJ37T4GHmz8\");\n  const body \u003d doc.getBody();\n  const textElement \u003d body.editAsText();\n\n  // Regex que captura \"Artigo \" + número, opcionalmente seguido por \u0027º\u0027\n  const regex \u003d /Artigo\\s+(\\d+)º?/g;\n\n  let contador \u003d 1;\n  let searchResult \u003d textElement.findText(regex.source);\n\n  while (searchResult !\u003d\u003d null) {\n    const foundText \u003d searchResult.getElement().asText();\n    const start \u003d searchResult.getStartOffset();\n    const end \u003d searchResult.getEndOffsetInclusive();\n\n    // Texto antigo do artigo (ex: \"Artigo 42º\")\n    const textoAchado \u003d foundText.getText().substring(start, end + 1);\n\n    // Deleta o texto antigo\n    foundText.deleteText(start, end);\n    // Insere o novo texto sem o símbolo e com a numeração atual\n    const novoTexto \u003d \"Artigo \" + contador;\n    foundText.insertText(start, novoTexto);\n\n    // Define o tamanho da fonte para o texto inserido\n    foundText.setFontSize(start, start + novoTexto.length - 1, 12);\n\n    contador++;\n    searchResult \u003d textElement.findText(regex.source, searchResult);\n  }\n\n  Logger.log(\"Artigos renumerados e com fonte tamanho 11!\");\n}\n"}]}