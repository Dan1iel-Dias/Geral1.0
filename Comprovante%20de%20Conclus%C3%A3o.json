{"files":[{"id":"SEU ID","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"ANYONE_ANONYMOUS\"\n  }\n}"},{"id":"c7edaa51-c7be-401a-8dad-79a0d3c148a0","name":"C√≥digo","type":"server_js","source":"function doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027index\u0027)\n    .setTitle(\u0027Declara√ß√£o de Conclus√£o\u0027);\n}\n\nfunction gerarDeclaracaoConclusao(dados) {\n  const modeloId \u003d \"1nGHHoLYthMiPK4zRvN4CHj_gYlIJDDXJnfxyewl4uJ8\"; // Substitua pelo ID do seu modelo no Google Docs\n  const pastaDestinoId \u003d \"1tTbtZbgOll7bBjcasQ5vEpELC1f2wKrY\"; // Substitua pelo ID da pasta destino\n\n  const pastaDestino \u003d DriveApp.getFolderById(pastaDestinoId);\n  const copia \u003d DriveApp.getFileById(modeloId).makeCopy(`Declara√ß√£o de Conclus√£o - ${dados.nome}`, pastaDestino);\n\n  const doc \u003d DocumentApp.openById(copia.getId());\n  const corpo \u003d doc.getBody();\n\n  corpo.replaceText(\u0027{{nome}}\u0027, dados.nome);\n  corpo.replaceText(\u0027{{rg}}\u0027, dados.rg);\n  corpo.replaceText(\u0027{{curso}}\u0027, dados.curso);\n  corpo.replaceText(\u0027{{data}}\u0027, dados.data);\n\n  const dataHoje \u003d new Date();\n  corpo.replaceText(\u0027{{DATA_HOJE}}\u0027, formatarDataPorExtenso(dataHoje));\n\n  doc.saveAndClose();\n\n  const url \u003d `https://docs.google.com/document/d/${doc.getId()}/edit`;\n  return `‚úÖ Declara√ß√£o gerada para ${dados.nome}!\u003cbr\u003e\u003ca href\u003d\"${url}\" target\u003d\"_blank\" style\u003d\"color: white;\"\u003eüëâ Abrir Documento\u003c/a\u003e`;\n}\n\nfunction formatarDataPorExtenso(data) {\n  const meses \u003d [\n    \"janeiro\", \"fevereiro\", \"mar√ßo\", \"abril\", \"maio\", \"junho\",\n    \"julho\", \"agosto\", \"setembro\", \"outubro\", \"novembro\", \"dezembro\"\n  ];\n\n  const dia \u003d data.getDate();\n  const mes \u003d meses[data.getMonth()];\n  const ano \u003d data.getFullYear();\n\n  return `${dia} de ${mes} de ${ano}`;\n}\n"},{"id":"62c426ed-f6eb-43cc-8d9e-45814a833e10","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003cstyle\u003e\n      body {\n        font-family: Arial, sans-serif;\n        background: linear-gradient(135deg, #1e3c72, #2a5298);\n        color: #fff;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        height: 100vh;\n        margin: 0;\n      }\n      .container {\n        background: rgba(30,144,255, 0.15);\n        padding: 25px;\n        border-radius: 15px;\n        max-width: 400px;\n        width: 100%;\n        box-shadow: 0 0 12px rgba(46, 204, 113, 0.7);\n      }\n      h2 {\n        text-align: center;\n        margin-bottom: 20px;\n      }\n      label {\n        display: block;\n        margin-top: 10px;\n        font-weight: bold;\n      }\n      input {\n        width: 100%;\n        padding: 10px;\n        margin-top: 5px;\n        border-radius: 8px;\n        border: none;\n        font-size: 14px;\n      }\n      button {\n        margin-top: 20px;\n        width: 100%;\n        padding: 12px;\n        border: none;\n        border-radius: 10px;\n        background: #2ecc71;\n        color: #fff;\n        font-size: 16px;\n        cursor: pointer;\n      }\n      #mensagem {\n        margin-top: 15px;\n        font-weight: bold;\n        text-align: center;\n      }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cdiv class\u003d\"container\"\u003e\n      \u003ch2\u003eüìú Gerar Declara√ß√£o de Conclus√£o\u003c/h2\u003e\n      \n      \u003clabel\u003eNome:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"nome\" placeholder\u003d\"Ex: Jo√£o da Silva\" required\u003e\n      \n      \u003clabel\u003eRG:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"rg\" placeholder\u003d\"Ex: 00.000.000-0\" required\u003e\n      \n      \u003clabel\u003eCurso:\u003c/label\u003e\n      \u003cinput type\u003d\"text\" id\u003d\"curso\" placeholder\u003d\"Ex: T√©cnico em Inform√°tica\" required\u003e\n      \n      \u003clabel\u003eData da Conclus√£o:\u003c/label\u003e\n      \u003cinput type\u003d\"date\" id\u003d\"data\" required\u003e\n      \n      \u003cbutton onclick\u003d\"gerar()\"\u003eGerar Documento\u003c/button\u003e\n      \n      \u003cdiv id\u003d\"mensagem\"\u003e\u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003cscript\u003e\n      function gerar() {\n        const nome \u003d document.getElementById(\"nome\").value.trim();\n        const rg \u003d document.getElementById(\"rg\").value.trim();\n        const curso \u003d document.getElementById(\"curso\").value.trim();\n        const data \u003d document.getElementById(\"data\").value;\n\n        if (!nome || !rg || !curso || !data) {\n          document.getElementById(\"mensagem\").innerText \u003d \"‚ùå Preencha todos os campos!\";\n          return;\n        }\n\n        // Formatar data do input YYYY-MM-DD para \"d de m√™s de aaaa\"\n        const dataObj \u003d new Date(data);\n        const meses \u003d [\n          \"janeiro\", \"fevereiro\", \"mar√ßo\", \"abril\", \"maio\", \"junho\",\n          \"julho\", \"agosto\", \"setembro\", \"outubro\", \"novembro\", \"dezembro\"\n        ];\n        const dataFormatada \u003d `${dataObj.getDate()} de ${meses[dataObj.getMonth()]} de ${dataObj.getFullYear()}`;\n\n        const dados \u003d { nome, rg, curso, data: dataFormatada };\n\n        document.getElementById(\"mensagem\").innerText \u003d \"‚è≥ Gerando...\";\n        google.script.run\n          .withSuccessHandler(msg \u003d\u003e {\n            document.getElementById(\"mensagem\").innerHTML \u003d msg;\n          })\n          .withFailureHandler(err \u003d\u003e {\n            document.getElementById(\"mensagem\").innerText \u003d \"‚ùå Erro: \" + err.message;\n          })\n          .gerarDeclaracaoConclusao(dados);\n      }\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}
