{"files":[{"id":"271ae897-0145-47ec-b16c-9e139790dcac","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Sao_Paulo\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_DEPLOYING\",\n    \"access\": \"MYSELF\"\n  }\n}"},{"id":"40d70c78-7119-4b82-8646-97051dff1a54","name":"C√≥digo","type":"server_js","source":"function doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027index\u0027);\n}\n\nfunction substituirCamposEMontarDoc(dados) {\n  try {\n    const docModelo \u003d DocumentApp.openById(dados.modeloId);\n    let texto \u003d docModelo.getBody().getText();\n\n    dados.substituicoes.forEach(item \u003d\u003e {\n      const chave \u003d `{{${item.chave}}}`;\n      texto \u003d texto.replaceAll(chave, item.valor);\n    });\n\n    const novoDoc \u003d DocumentApp.create(dados.titulo || \"Documento Gerado\");\n    novoDoc.getBody().setText(texto);\n\n    return `‚úÖ Documento gerado com sucesso: \u003ca href\u003d\"${novoDoc.getUrl()}\" target\u003d\"_blank\"\u003eAbrir Documento\u003c/a\u003e`;\n  } catch (e) {\n    return \"‚ö†Ô∏è Erro: \" + e.message;\n  }\n}\n"},{"id":"e456d8b7-7889-4d55-9f52-b0e92ade360a","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cbase target\u003d\"_top\"\u003e\n    \u003cstyle\u003e\n      body { font-family: Arial, sans-serif; padding: 20px; }\n      input { width: 100%; margin-bottom: 10px; padding: 8px; box-sizing: border-box; }\n      button { padding: 10px 20px; background-color: #0b8043; color: white; border: none; border-radius: 5px; }\n      button:hover { background-color: #0a6e37; }\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003ch2\u003eüìÑ Gerador de Documento com Campos Vari√°veis\u003c/h2\u003e\n\n    \u003clabel\u003e\u003cstrong\u003eID do Documento Modelo:\u003c/strong\u003e\u003c/label\u003e\n    \u003cinput id\u003d\"modeloId\" placeholder\u003d\"Ex: 1a2b3c4d5e6f...\" /\u003e\n\n    \u003clabel\u003e\u003cstrong\u003eT√≠tulo do novo documento:\u003c/strong\u003e\u003c/label\u003e\n    \u003cinput id\u003d\"titulo\" placeholder\u003d\"Ex: Aviso para Jo√£o\" /\u003e\n\n    \u003clabel\u003e\u003cstrong\u003eCampos a substituir (use {{chave}} no modelo):\u003c/strong\u003e\u003c/label\u003e\n    \u003cdiv id\u003d\"campos\"\u003e\n      \u003cdiv\u003e\n        \u003cinput placeholder\u003d\"Campo (ex: nome)\" class\u003d\"chave\" /\u003e\n        \u003cinput placeholder\u003d\"Valor (ex: Jo√£o da Silva)\" class\u003d\"valor\" /\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n\n    \u003cbutton onclick\u003d\"adicionarCampo()\"\u003e‚ûï Adicionar Campo\u003c/button\u003e\n    \u003cbr\u003e\u003cbr\u003e\n    \u003cbutton onclick\u003d\"gerar()\"\u003eüöÄ Gerar Documento\u003c/button\u003e\n\n    \u003cdiv id\u003d\"resultado\" style\u003d\"margin-top: 20px;\"\u003e\u003c/div\u003e\n\n    \u003cscript\u003e\n      function adicionarCampo() {\n        const div \u003d document.createElement(\"div\");\n        div.innerHTML \u003d `\n          \u003cinput placeholder\u003d\"Campo (ex: nome)\" class\u003d\"chave\" /\u003e\n          \u003cinput placeholder\u003d\"Valor (ex: Jo√£o da Silva)\" class\u003d\"valor\" /\u003e\n        `;\n        document.getElementById(\"campos\").appendChild(div);\n      }\n\n      function gerar() {\n        const modeloId \u003d document.getElementById(\"modeloId\").value.trim();\n        const titulo \u003d document.getElementById(\"titulo\").value.trim();\n        const chaves \u003d document.querySelectorAll(\".chave\");\n        const valores \u003d document.querySelectorAll(\".valor\");\n\n        let substituicoes \u003d [];\n        for (let i \u003d 0; i \u003c chaves.length; i++) {\n          const chave \u003d chaves[i].value.trim();\n          const valor \u003d valores[i].value.trim();\n          if (chave \u0026\u0026 valor) {\n            substituicoes.push({ chave, valor });\n          }\n        }\n\n        const dados \u003d { modeloId, titulo, substituicoes };\n\n        document.getElementById(\"resultado\").innerHTML \u003d \"‚è≥ Gerando...\";\n        google.script.run\n          .withSuccessHandler(msg \u003d\u003e {\n            document.getElementById(\"resultado\").innerHTML \u003d msg;\n          })\n          .substituirCamposEMontarDoc(dados);\n      }\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n"}]}